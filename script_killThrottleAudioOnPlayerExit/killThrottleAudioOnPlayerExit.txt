-- Register the behaviour
behaviour("killThrottleAudioOnPlayerExit")

function killThrottleAudioOnPlayerExit:Start()
	-- Run when behaviour is created
	self.vehicle = self.targets.vehicleTarget.gameObject.getComponent(Vehicle)
	self.throttleAudio = self.transform.parent.gameObject.getComponent(AudioSource)
	self.playerWasInCar = false
	self.toggleAudio = false
end

-- for next update, check if there are any passengers left in the vehicle --

function killThrottleAudioOnPlayerExit:Update()
	-- Run every frame
	if self.vehicle.playerIsInside == true then
		if self.playerWasInCar == false then
			self.playerWasInCar = true
		end
		if self.toggleAudio == false then
			if self.vehicle.hasDriver then
				-- if there's a driver..
				-- turn volume back on
				self.toggleAudio = true 
				self.throttleAudio.mute = false
			end
		end
	else -- if player is not in vehicle..
		if self.playerWasInCar == true then
			--but if player WAS in vehicle last frame..
			self.playerWasInCar = false
			if self.throttleAudio.isPlaying == true then
				-- if audio is still playing..
				-- turn audio off.
				self.toggleAudio = false
				self.throttleAudio.mute = true
			end
		end
	end
end
